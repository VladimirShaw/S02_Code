# Arduino Template 串口命令手册

## 基本说明
- 波特率：115200
- 命令以回车结尾
- 大小写敏感

---

## PWM控制命令

### 简化PWM命令
```
p24 128        # 设置引脚24的PWM值为128 (0-255)
p24 0          # 关闭引脚24的PWM
s24            # 停止引脚24的PWM
```

### 简化呼吸命令
```
b24 1000       # 引脚24开始呼吸效果，周期1000ms
```

### 简化渐变命令
```
f24 1000       # 引脚24渐入到最亮，用时1000ms
fo24 1000      # 引脚24渐出到0，用时1000ms
ft24 128 1000  # 引脚24渐变到128，用时1000ms
fs24           # 停止引脚24的渐变
```

### 批量PWM命令（连续10个引脚）
```
pa20 128       # 引脚20-29批量设置PWM为128
ba10 1000      # 引脚10-19批量呼吸效果，周期1000ms
sa20           # 引脚20-29批量停止
```

### 完整PWM命令
```
pwm_set:24,128                    # 设置引脚24的PWM值为128
pwm_breathing:24,1000             # 引脚24呼吸效果，周期1000ms
pwm_stop:24                       # 停止引脚24的PWM
pwm_stop_all                      # 停止所有PWM
```

### 完整渐变命令
```
pwm_fadein:24,255,1000            # 引脚24渐入到255，用时1000ms
pwm_fadeout:24,1000               # 引脚24渐出到0，用时1000ms
pwm_fadeto:24,128,1000            # 引脚24渐变到128，用时1000ms
pwm_stop_fade:24                  # 停止引脚24的渐变
```

### PWM通道管理命令
```
pwm_status         # 查看PWM通道状态
pwm_compact        # 手动压缩PWM通道，释放非活跃通道
pwm_reset          # 重置所有PWM通道
```

---

## 数字IO控制命令

### 基础数字输出
```
o24h           # 引脚24输出高电平
o24l           # 引脚24输出低电平
```

### 脉冲输出
```
pulse24:1000   # 引脚24输出1000ms脉冲
```

### 定时输出
```
t24h:500:2000  # 引脚24延迟500ms后输出高电平，持续2000ms
t24l:500:2000  # 引脚24延迟500ms后输出低电平，持续2000ms
```

### 输入监控
```
i25            # 监控引脚25的输入状态
```

---

## 游戏控制命令

### 基础游戏命令
```
INIT           # 初始化游戏
START          # 开始游戏
STOP           # 停止游戏
PAUSE          # 暂停游戏
RESUME         # 恢复游戏
```

### 环节测试命令
```
001-0          # 启动环节001-0 (示例)
stage_001_1    # 启动环节stage_001_1 (示例)
<stage_id>     # 启动任意环节ID
```

### 手动协议发送
```
send_init      # 发送初始化命令
send_start     # 发送开始命令
send_stop      # 发送停止命令
send_pause     # 发送暂停命令
send_resume    # 发送恢复命令
send_emergency # 发送紧急停止命令
```

### 006_0环节配置参数

**游戏核心参数：**
- `STAGE_006_0_REQUIRED_CORRECT = 4` - 需要连续正确次数
- `STAGE_006_0_SUCCESS_JUMP = "010"` - 成功后跳转目标

**时间控制参数：**
- `STAGE_006_0_CORRECT_PROCESS_TIME = 1000` - 正确按键后等待时间(ms)
- `STAGE_006_0_ERROR_PROCESS_TIME = 2000` - 错误按键处理时间(ms)  
- `STAGE_006_0_ERROR_WAIT_TIME = 6000` - 错误后等待时间(ms)
- `STAGE_006_0_VOICE_TRIGGER_LOW_TIME = 1000` - 语音IO低电平保持时间(ms)

**植物灯效果参数：**
- `STAGE_006_0_PLANT_ON_DELAY = 375` - 植物灯点亮间隔(ms)
- `STAGE_006_0_PLANT_OFF_DELAY = 375` - 植物灯熄灭间隔(ms)
- `STAGE_006_0_PLANT_BREATH_DURATION = 3000` - 植物灯呼吸周期(ms)

**按键防抖参数：**
- `STAGE_006_0_BUTTON_DEBOUNCE_TIME = 50` - 按键防抖时间(ms)

**时间流程说明：**
1. **正确按键流程**：按键响应 → 等待1秒(`CORRECT_PROCESS_TIME`) → 准备下一轮 → 等待6秒(`ERROR_WAIT_TIME`) → 开始下一轮
2. **错误按键流程**：按键响应 → 等待2秒(`ERROR_PROCESS_TIME`) → 准备下一轮 → 等待6秒(`ERROR_WAIT_TIME`) → 开始下一轮

---

## 网络命令 (需要ENABLE_NETWORK=true)

### 网络状态
```
network        # 查看网络连接状态
```

### 发送消息
```
send Hello     # 发送消息到服务器
```

---

## 系统命令

### 帮助和状态
```
help           # 显示帮助信息
h              # 显示帮助信息（简写）
status         # 显示系统状态
```

### 系统控制
```
reset          # 重置系统
debug          # 显示调试信息
time           # 显示系统时间
```

### 停止所有输出
```
pwm_stop_all   # 停止所有PWM输出
dio_stop_all   # 停止所有数字IO输出
```

### 状态查询
```
dio_status     # 查看数字IO状态
```

---

## 命令格式说明

### 引脚号
- 支持任意数字引脚号，如：24, 26, 28, 30等

### PWM值
- 范围：0-255
- 0 = 完全关闭
- 255 = 最亮/最大

### 时间
- 单位：毫秒(ms)
- 例如：1000 = 1秒

### 环节名称
- 格式：任意字符串
- 例如：072-4, 073-1, START, END等

### 会话ID
- 格式：任意字符串
- 例如：ABC123, SESSION_001等

---

## 使用示例

### 1. 简单LED控制
```
p24 255        # LED全亮
p24 128        # LED半亮
p24 0          # LED关闭
s24            # 停止LED
```

### 2. 渐变效果
```
f24 2000       # LED渐亮，用时2秒
fo24 2000      # LED渐暗，用时2秒
ft24 128 1000  # LED渐变到半亮，用时1秒
fs24           # 停止渐变
```

### 3. 呼吸效果
```
b24 2000       # 开始呼吸，周期2秒
s24            # 停止呼吸
```

### 4. 数字输出控制
```
o26h           # 继电器开启
o26l           # 继电器关闭
pulse30:500    # 蜂鸣器响500ms
```