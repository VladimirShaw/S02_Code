# C101 006_0环节测试指南

## 环节概述
006_0是一个嘲讽按键音频匹配游戏，玩家需要根据音频提示按下正确的按键，连续4次正确才能通关。

## 游戏机制

### 1. 音频提示与按键映射
- 语音IO1播放 → 正确按键1
- 语音IO2播放 → 正确按键2  
- 语音IO3播放 → 正确按键3
- 语音IO4播放 → 正确按键4

### 2. 计数器m的轮播规则
- m从1开始，每次按键后+1
- m%4的结果决定播放哪个语音IO：
  - m%4=0 → IO1 → 按键1正确
  - m%4=1 → IO3 → 按键3正确
  - m%4=2 → IO2 → 按键2正确
  - m%4=3 → IO4 → 按键4正确

### 3. 游戏流程
1. 4个嘲讽按键开始呼吸效果（10秒循环）
2. 播放第一个语音提示（m=1, 播放IO3）
3. 玩家按键：
   - 正确：植物灯依次点亮，继续下一轮
   - 错误：植物灯依次熄灭，3秒后重新开始

### 4. 胜利条件
连续4次按对即可通关，跳转到010环节

## 测试命令

### 启动006环节
```
JUMP_STAGE:006_0
```

### 模拟按键测试
由于是硬件按键，需要实际按下对应的按键进行测试。

### 测试序列示例
假设从头开始（m=1）：
1. 第1轮：播放IO3 → 应按按键3
2. 第2轮：播放IO2 → 应按按键2  
3. 第3轮：播放IO4 → 应按按键4
4. 第4轮：播放IO1 → 应按按键1

## 视觉反馈

### 正确时
- 被按下的按键保持亮起
- 植物灯依次点亮（375ms间隔）
- 植物灯保持呼吸效果（3秒周期）

### 错误时
- 植物灯依次熄灭（0/375/750/1125ms）
- 错误按键在1125ms时熄灭
- 3秒后重新开始

## 服务器通信

### 按键后的跳转指令
根据m%4的结果发送：
- m%4=0 → 发送"211"
- m%4=1 → 发送"213"
- m%4=2 → 发送"212"
- m%4=3 → 发送"214"

### 错误跳转
根据总数m，每两次为一组：
- m=1,2 → 发送"3"
- m=3,4 → 发送"4"
- m=5,6 → 发送"5"
- 然后循环...

### 成功跳转
4次全对后发送跳转到"010"

## 硬件配置

### 嘲讽按键
- 按键1：Pin31 (COM检测), Pin30 (灯光)
- 按键2：Pin33 (COM检测), Pin32 (灯光)
- 按键3：Pin35 (COM检测), Pin34 (灯光)
- 按键4：Pin37 (COM检测), Pin36 (灯光)

### 语音IO
- IO1：Pin15
- IO2：Pin16
- IO3：PinA4
- IO4：Pin20

### 植物灯
- 植物灯1：Pin2
- 植物灯2：Pin3
- 植物灯3：Pin6
- 植物灯4：Pin5

## 注意事项
1. 语音IO是LOW触发，保持1秒后恢复HIGH
2. 按键是INPUT_PULLUP模式，按下时为LOW
3. 必须连续4次正确，任何错误都会重置计数
4. 错误后m值继续累加，不会重置 